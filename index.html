<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sonsuza Dek Biz | 03.04.2025</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&family=Dancing+Script:wght@700&display=swap');
        body { margin: 0; background: #0f0f0f; color: #fff; font-family: 'Poppins', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; touch-action: none; }
        #login-screen, #start-screen, #clip-container, #note-screen, #menu-screen { text-align: center; padding: 30px; background: rgba(25, 25, 25, 0.98); border-radius: 35px; border: 1px solid #ff4081; box-shadow: 0 0 40px rgba(255, 64, 129, 0.2); width: 90%; max-width: 800px; transition: all 0.8s ease; box-sizing: border-box; position: absolute; }
        #start-screen, #clip-container, #note-screen, #menu-screen { display: none; }
        .milat-baslik { font-family: 'Dancing Script', cursive; font-size: 2.8rem; color: #ff4081; margin-bottom: 10px; display: block; }
        #timer, #timer-menu { font-size: 1.4rem; color: #ff80ab; font-weight: 600; display: block; margin-top: 10px; letter-spacing: 1px; }
        .media-box { width: 100%; height: 400px; background: #000; border-radius: 20px; display: flex; justify-content: center; align-items: center; overflow: hidden; border: 2px solid #222; position: relative; }
        .myMedia { display: none; max-width: 100%; max-height: 100%; object-fit: contain; animation: sinematikGecis 1.2s ease-in-out; }
        @keyframes sinematikGecis { from { opacity: 0; transform: scale(1.05); } to { opacity: 1; transform: scale(1); } }
        .text-area { margin-top: 25px; min-height: 80px; font-size: 1.2rem; font-weight: 300; color: #ff80ab; font-style: italic; text-shadow: 0 0 15px rgba(255,128,171,0.3); padding: 0 10px; }
        .heart-btn { background: #ff4081; color: white; border: none; padding: 15px 35px; border-radius: 50px; cursor: pointer; font-size: 1.1rem; font-weight: 600; box-shadow: 0 5px 25px rgba(255, 64, 129, 0.4); transition: 0.4s; text-transform: uppercase; margin: 5px; }
        .heart-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255, 64, 129, 0.6); }
        input, textarea { background: #1a1a1a; border: 1px solid #ff4081; color: white; padding: 15px; border-radius: 20px; width: 80%; text-align: center; font-size: 1.1rem; outline: none; margin-bottom: 15px; }
        textarea { height: 100px; resize: none; font-family: 'Poppins', sans-serif; }
        
        /* Ã‡izim Ã–nizleme Kutusu */
        #canvas-preview { background: #fff; border-radius: 20px; margin: 15px auto; width: 100%; max-width: 500px; height: 150px; border: 3px dashed #ff4081; cursor: zoom-in; display: flex; align-items: center; justify-content: center; color: #ff4081; font-weight: bold; overflow: hidden; }
        #canvas-preview img { max-width: 100%; height: auto; }

        /* TAM EKRAN Ã‡Ä°ZÄ°M MODAL */
        #drawing-modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 1000; flex-direction: column; }
        #tool-bar { background: #f8f8f8; padding: 10px; display: flex; gap: 8px; overflow-x: auto; border-bottom: 2px solid #eee; align-items: center; }
        .tool-btn { padding: 10px; border-radius: 12px; border: 1px solid #ddd; background: white; cursor: pointer; min-width: 45px; color: #333; font-size: 0.9rem; }
        .tool-btn.active { background: #ff4081; color: white; border-color: #ff4081; }
        #paint-canvas { flex-grow: 1; cursor: crosshair; touch-action: none; background: white; }

        #notes-list { max-height: 200px; overflow-y: auto; margin-top: 20px; text-align: left; padding: 10px; border-top: 1px solid #333; }
        .note-item { background: rgba(255, 64, 129, 0.1); padding: 10px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid #ff4081; font-size: 0.9rem; }
        .note-img { max-width: 100%; border-radius: 5px; margin-top: 5px; background: white; display: block; }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px; }
        @media (max-width: 600px) { .media-box { height: 300px; } .milat-baslik { font-size: 2.2rem; } .menu-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="login-screen">
        <h2 style="font-family: 'Dancing Script', cursive; font-size: 3rem; margin-bottom: 20px;">Kalbimin AnahtarÄ±? â¤ï¸</h2>
        <input type="password" id="passInput" placeholder="Sadece Bize Ã–zel Åifre...">
        <br>
        <button class="heart-btn" onclick="checkPassword()">AÅŸkÄ±mÄ±zÄ±n KapÄ±sÄ±nÄ± Arala</button>
    </div>

    <div id="menu-screen">
        <h2 class="milat-baslik">HoÅŸ Geldin Ã–mrÃ¼m</h2>
        <div id="timer-menu"></div>
        <div class="menu-grid">
            <button class="heart-btn" onclick="startStory()">AnÄ±larÄ±mÄ±zÄ± Ä°zle ğŸ“¸</button>
            <button class="heart-btn" onclick="openNoteScreen()">AÅŸk NotlarÄ±mÄ±z ğŸ“</button>
        </div>
    </div>

    <div id="start-screen">
        <span class="milat-baslik">YolculuÄŸumuzun Ä°lk Nefesi...</span>
        <p style="font-size: 1.1rem; opacity: 0.8; margin: 0;">Ruhumun evini bulduÄŸu o mucizevi gÃ¼nden beri tam;</p>
        <span id="timer"></span>
        <p style="font-size: 1.1rem; opacity: 0.8; margin: 0;">geÃ§ti.</p>
        <br>
        <button class="heart-btn" onclick="startStory()">AnÄ±larÄ±mÄ±za Yolculuk Yapâœ¨</button>
    </div>

    <div id="clip-container">
        <div class="media-box">
            <img src="resim1.jpeg" class="myMedia"><img src="resim2.jpeg" class="myMedia"><img src="resim3.jpeg" class="myMedia">
            <img src="resim4.jpeg" class="myMedia"><img src="resim5.jpeg" class="myMedia"><img src="resim6.jpeg" class="myMedia">
            <img src="resim7.jpeg" class="myMedia"><img src="resim8.jpeg" class="myMedia"><img src="resim9.jpeg" class="myMedia">
            <img src="resim10.jpeg" class="myMedia"><img src="resim11.jpeg" class="myMedia"><img src="resim12.jpeg" class="myMedia">
            <img src="resim13.jpeg" class="myMedia"><video class="myMedia" id="myVid" playsinline muted><source src="video.mp4" type="video/mp4"></video>
            <img src="resim14.jpeg" class="myMedia">
        </div>
        <div id="message-text" class="text-area"></div>
        <audio id="mainMusic" src="muzik.mp3" loop></audio>
    </div>

    <div id="note-screen">
        <h2 class="milat-baslik">GeleceÄŸimize Not BÄ±rak</h2>
        <textarea id="noteInput" placeholder="Buraya kalbinden geÃ§enleri yaz sevgilim..."></textarea>
        <div id="canvas-preview" onclick="openDrawingModal()">
            <span>Tuvali BÃ¼yÃ¼t ve Ã‡izmeye BaÅŸla âœ¨</span>
        </div>
        <button class="heart-btn" onclick="saveNote()">Notu Kaydet â¤ï¸</button>
        <button class="heart-btn" onclick="backToMenu()" style="background: #333;">Geri DÃ¶n</button>
        <div id="notes-list"></div>
    </div>

    <div id="drawing-modal">
        <div id="tool-bar">
            <button class="tool-btn active" onclick="setTool('pen', this)">âœï¸ Ä°nce</button>
            <button class="tool-btn" onclick="setTool('marker', this)">ğŸ–ï¸ KalÄ±n</button>
            <button class="tool-btn" onclick="setTool('eraser', this)">ğŸ§¹ Silgi</button>
            <input type="color" id="colorPicker" onchange="updateColor(this.value)" style="width:40px; height:40px; border:none; cursor:pointer;">
            <select id="emojiPicker" onchange="addEmoji(this.value)" class="tool-btn">
                <option value="">ğŸ˜Š Emoji</option>
                <option value="â¤ï¸">â¤ï¸</option><option value="ğŸŒ¸">ğŸŒ¸</option><option value="âœ¨">âœ¨</option><option value="ğŸ’">ğŸ’</option><option value="ğŸ§¸">ğŸ§¸</option>
            </select>
            <button class="tool-btn" onclick="clearCanvas()" style="background:#ffebee;">ğŸ—‘ï¸</button>
            <button class="heart-btn" onclick="closeDrawingModal()" style="margin-left:auto; padding: 10px 20px; font-size:0.9rem;">TAMAM</button>
        </div>
        <canvas id="paint-canvas"></canvas>
    </div>

    <script>
        const TANIÅMA_TARÄ°HÄ° = "2025-04-03"; 
        const mesajlar = [
            "HenÃ¼z birbirimizden habersizken bile kalplerimiz bu gÃ¼n iÃ§in atÄ±yormuÅŸ...",
            "Daha 'biz' olmadan Ã¶nce Ã§ekilen bu kare, hayatÄ±mÄ±n en gÃ¼zel dÃ¶nÃ¼m noktasÄ±ymÄ±ÅŸ.",
            "'GÃ¶zleriniz birbirine ne kadar benziyor' dedikleri o gÃ¼n, ruhlarÄ±mÄ±zÄ±n benzerliÄŸini keÅŸfetmiÅŸtik.",
            "Bakmaya doyamadÄ±ÄŸÄ±m her karemizde, dÃ¼nyam seninle daha parlak gÃ¶rÃ¼nÃ¼yor.",
            "Sadece bir fotoÄŸraf deÄŸil, senin yanÄ±nda kendimi bulduÄŸum bir sÄ±ÄŸÄ±nak bu.",
            "ZamanÄ±n durmasÄ±nÄ± istediÄŸim binlerce andan sadece biri...",
            "Sen benim en gÃ¼zel manzaramsÄ±n, her bakÄ±ÅŸta yeniden huzur bulduÄŸum.",
            "Birlikte Ã§ocuk gibi eÄŸlenebildiÄŸim tek insan olman ne bÃ¼yÃ¼k ÅŸans!",
            "AÅŸk sadece el ele tutuÅŸmak deÄŸil, saÃ§malarken bile aynÄ± ritimde olmaktÄ±r.",
            "GÃ¼lÃ¼ÅŸÃ¼nÃ¼n iÃ§inde saklÄ± olan o neÅŸe, en kÃ¶tÃ¼ gÃ¼nÃ¼mÃ¼n bile ilacÄ±.",
            "Seninle gÃ¼lmekten yorulmak, hayatÄ±n bana sunduÄŸu en gÃ¼zel yorgunluk.",
            "DÃ¼nyanÄ±n en komik ama en romantik sahnelerinin baÅŸrolÃ¼ her zaman biziz.",
            "AynÄ± renklere gÃ¶nÃ¼l vermek, aynÄ± heyecanla birleÅŸmek... Galibiyetimiz hep 'biz' olalÄ±m.",
            "DÃ¼nyaya senin gÃ¶zlerinden bakmak, gÃ¶rdÃ¼ÄŸÃ¼m en gÃ¼zel gerÃ§eklik.",
            "TÃ¼m dileklerinin gerÃ§ek olduÄŸu, hayallerimizle sÃ¼slÃ¼ nice mutlu senelerimize Ã¶mrÃ¼mmmmm:)"
        ];

        let currentIndex = 0;
        const mainMusic = document.getElementById('mainMusic');
        const canvas = document.getElementById('paint-canvas');
        const ctx = canvas.getContext('2d');
        let drawing = false, currentTool = 'pen', currentColor = '#000';

        function checkPassword() {
            if(document.getElementById('passInput').value === "2240") {
                document.getElementById('login-screen').style.display = 'none';
                localStorage.getItem('ask_notlari') ? document.getElementById('menu-screen').style.display = 'block' : document.getElementById('start-screen').style.display = 'block';
                updateTimer(); setInterval(updateTimer, 1000);
            } else { alert("HatalÄ± ÅŸifre hayatÄ±m!"); }
        }

        function updateTimer() {
            const diff = new Date() - new Date(TANIÅMA_TARÄ°HÄ°);
            const days = Math.floor(diff / 86400000);
            const hours = Math.floor((diff % 86400000) / 3600000);
            const mins = Math.floor((diff % 3600000) / 60000);
            const secs = Math.floor((diff % 60000) / 1000);
            const text = `${days} GÃ¼n, ${hours} Saat, ${mins} Dakika, ${secs} Saniye`;
            if(document.getElementById('timer')) document.getElementById('timer').innerText = text;
            if(document.getElementById('timer-menu')) document.getElementById('timer-menu').innerText = text;
        }

        function startStory() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('clip-container').style.display = 'block';
            currentIndex = 0; mainMusic.play(); showNext();
        }

        function showNext() {
            let media = document.getElementsByClassName("myMedia"), textDiv = document.getElementById("message-text");
            if (currentIndex >= media.length) {
                textDiv.innerHTML = `Sonsuza dek seninle... â¤ï¸ <br><br> 
                    <button class='heart-btn' onclick='startStory()' style='font-size: 0.8rem;'>Yeniden Ä°zle</button>
                    <button class='heart-btn' onclick='openNoteScreen()' style='font-size: 0.8rem; background: #ad1457;'>Not BÄ±rak</button>`;
                return;
            }
            for (let i = 0; i < media.length; i++) { media[i].style.display = "none"; if(media[i].tagName === "VIDEO") media[i].pause(); }
            media[currentIndex].style.display = "block"; textDiv.innerHTML = mesajlar[currentIndex];
            if (media[currentIndex].tagName === "VIDEO") {
                media[currentIndex].currentTime = 0; media[currentIndex].play();
                media[currentIndex].onended = () => { currentIndex++; showNext(); };
            } else { currentIndex++; setTimeout(showNext, 6000); }
        }

        // Ã‡izim FonksiyonlarÄ±
        function openDrawingModal() {
            document.getElementById('drawing-modal').style.display = 'flex';
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight - document.getElementById('tool-bar').offsetHeight;
            ctx.lineCap = 'round'; ctx.strokeStyle = currentColor;
            initDrawing();
        }

        function closeDrawingModal() {
            const preview = document.getElementById('canvas-preview');
            preview.innerHTML = `<img src="${canvas.toDataURL()}">`;
            document.getElementById('drawing-modal').style.display = 'none';
        }

        function setTool(tool, btn) {
            currentTool = tool;
            document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            ctx.globalCompositeOperation = (tool === 'eraser') ? 'destination-out' : 'source-over';
            ctx.lineWidth = (tool === 'marker') ? 15 : 4;
        }

        function updateColor(val) { currentColor = val; ctx.strokeStyle = val; }
        function addEmoji(val) { if(!val) return; ctx.font = "60px serif"; ctx.fillText(val, canvas.width/2, canvas.height/2); }
        function clearCanvas() { ctx.clearRect(0,0,canvas.width, canvas.height); }

        function initDrawing() {
            const getPos = (e) => {
                const rect = canvas.getBoundingClientRect();
                return { x: (e.clientX || e.touches[0].clientX) - rect.left, y: (e.clientY || e.touches[0].clientY) - rect.top };
            };
            const start = (e) => { drawing = true; const pos = getPos(e); ctx.beginPath(); ctx.moveTo(pos.x, pos.y); };
            const move = (e) => { if(!drawing) return; const pos = getPos(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); };
            const stop = () => drawing = false;
            canvas.onmousedown = start; canvas.onmousemove = move; window.onmouseup = stop;
            canvas.ontouchstart = (e) => { e.preventDefault(); start(e); };
            canvas.ontouchmove = (e) => { e.preventDefault(); move(e); };
            canvas.ontouchend = stop;
        }

        function openNoteScreen() {
            document.getElementById('clip-container').style.display = 'none';
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('note-screen').style.display = 'block';
            displayNotes();
        }

        function saveNote() {
            const text = document.getElementById('noteInput').value;
            const img = canvas.toDataURL();
            const notes = JSON.parse(localStorage.getItem('ask_notlari') || "[]");
            notes.unshift({ text, image: img, date: new Date().toLocaleString('tr-TR') });
            localStorage.setItem('ask_notlari', JSON.stringify(notes));
            alert("Ã–lÃ¼msÃ¼zleÅŸtirildi! â¤ï¸"); location.reload();
        }

        function displayNotes() {
            const notes = JSON.parse(localStorage.getItem('ask_notlari') || "[]");
            document.getElementById('notes-list').innerHTML = notes.map(n => `
                <div class="note-item"><small>${n.date}</small><div>${n.text}</div><img src="${n.image}" class="note-img"></div>
            `).join('');
        }

        function backToMenu() {
            if(localStorage.getItem('ask_notlari')) location.reload();
            else openNoteScreen();
        }
    </script>
</body>
</html>
