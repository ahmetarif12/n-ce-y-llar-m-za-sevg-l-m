<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sonsuza Dek Biz | 03.04.2025</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&family=Dancing+Script:wght@700&display=swap');
        
        body { margin: 0; background: #0f0f0f; color: #fff; font-family: 'Poppins', sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; touch-action: none; }
        
        #login-screen, #start-screen, #clip-container, #note-screen, #menu-screen { 
            text-align: center; padding: 25px; background: rgba(25, 25, 25, 0.98); border-radius: 35px; 
            border: 1px solid #ff4081; box-shadow: 0 0 40px rgba(255, 64, 129, 0.2); 
            width: 92%; max-width: 800px; transition: all 0.5s ease; box-sizing: border-box; position: absolute; 
        }

        #start-screen, #clip-container, #note-screen, #menu-screen { display: none; }

        .milat-baslik { font-family: 'Dancing Script', cursive; font-size: 2.8rem; color: #ff4081; margin-bottom: 10px; display: block; }
        #timer, #timer-menu { font-size: 1.3rem; color: #ff80ab; font-weight: 600; display: block; margin-top: 10px; letter-spacing: 1px; }

        .media-box { width: 100%; height: 380px; background: #000; border-radius: 20px; display: flex; justify-content: center; align-items: center; overflow: hidden; border: 2px solid #222; position: relative; }
        .myMedia { display: none; max-width: 100%; max-height: 100%; object-fit: contain; animation: sinematikGecis 1.2s ease-in-out; }

        @keyframes sinematikGecis { from { opacity: 0; transform: scale(1.05); } to { opacity: 1; transform: scale(1); } }

        .text-area { margin-top: 25px; min-height: 80px; font-size: 1.2rem; font-weight: 300; color: #ff80ab; font-style: italic; text-shadow: 0 0 15px rgba(255,128,171,0.3); padding: 0 10px; }

        .heart-btn { background: #ff4081; color: white; border: none; padding: 15px 30px; border-radius: 50px; cursor: pointer; font-size: 1rem; font-weight: 600; box-shadow: 0 5px 25px rgba(255, 64, 129, 0.4); transition: 0.4s; text-transform: uppercase; margin: 5px; }
        .heart-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 30px rgba(255, 64, 129, 0.6); }

        /* √áizim Alanƒ± */
        #canvas-wrap { background: #fff; border-radius: 20px; margin: 15px auto; width: 100%; max-width: 550px; height: 220px; position: relative; cursor: crosshair; touch-action: none; border: 3px solid #ff4081; }
        #noteCanvas { width: 100%; height: 100%; border-radius: 17px; }

        input, textarea { background: #1a1a1a; border: 1px solid #ff4081; color: white; padding: 15px; border-radius: 20px; width: 85%; text-align: center; font-size: 1.1rem; outline: none; margin-bottom: 15px; }
        textarea { height: 70px; resize: none; font-family: 'Poppins', sans-serif; }

        #notes-list { max-height: 180px; overflow-y: auto; margin-top: 20px; text-align: left; padding: 10px; border-top: 1px solid #333; }
        .note-item { background: rgba(255, 64, 129, 0.1); padding: 12px; border-radius: 15px; margin-bottom: 12px; border-left: 5px solid #ff4081; }
        .note-img { max-width: 100%; border-radius: 10px; margin-top: 8px; background: white; display: block; }
        
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 25px; }
        @media (max-width: 600px) { .media-box { height: 300px; } .milat-baslik { font-size: 2.2rem; } .menu-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <div id="login-screen">
        <h2 style="font-family: 'Dancing Script', cursive; font-size: 3rem; margin-bottom: 20px;">Kalbimin Anahtarƒ±? ‚ù§Ô∏è</h2>
        <input type="password" id="passInput" placeholder="Sadece Bize √ñzel ≈ûifre...">
        <br>
        <button class="heart-btn" onclick="checkPassword()">A≈ükƒ±mƒ±zƒ±n Kapƒ±sƒ±nƒ± Arala</button>
    </div>

    <div id="menu-screen">
        <h2 class="milat-baslik">Ho≈ü Geldin √ñmr√ºm</h2>
        <div id="timer-menu"></div>
        <div class="menu-grid">
            <button class="heart-btn" onclick="startStory()">Anƒ±larƒ±mƒ±zƒ± ƒ∞zle üì∏</button>
            <button class="heart-btn" onclick="openNoteScreen()">A≈ük Notlarƒ±mƒ±z üìù</button>
        </div>
    </div>

    <div id="start-screen">
        <span class="milat-baslik">Yolculuƒüumuzun ƒ∞lk Nefesi...</span>
        <p style="font-size: 1.1rem; opacity: 0.8; margin: 0;">Ruhumun evini bulduƒüu o mucizevi g√ºnden beri tam;</p>
        <span id="timer"></span>
        <p style="font-size: 1.1rem; opacity: 0.8; margin: 0;">ge√ßti.</p>
        <br>
        <button class="heart-btn" onclick="startStory()">Anƒ±larƒ±mƒ±za Yolculuk Yap‚ú®</button>
    </div>

    <div id="clip-container">
        <div class="media-box">
            <img src="resim1.jpeg" class="myMedia">
            <img src="resim2.jpeg" class="myMedia">
            <img src="resim3.jpeg" class="myMedia">
            <img src="resim4.jpeg" class="myMedia">
            <img src="resim5.jpeg" class="myMedia">
            <img src="resim6.jpeg" class="myMedia">
            <img src="resim7.jpeg" class="myMedia">
            <img src="resim8.jpeg" class="myMedia">
            <img src="resim9.jpeg" class="myMedia">
            <img src="resim10.jpeg" class="myMedia">
            <img src="resim11.jpeg" class="myMedia">
            <img src="resim12.jpeg" class="myMedia">
            <img src="resim13.jpeg" class="myMedia">
            <video class="myMedia" id="myVid" playsinline muted><source src="video.mp4" type="video/mp4"></video>
            <img src="resim14.jpeg" class="myMedia">
        </div>
        <div id="message-text" class="text-area"></div>
        <audio id="mainMusic" src="muzik.mp3" loop></audio>
    </div>

    <div id="note-screen">
        <h2 class="milat-baslik" style="font-size: 2rem;">Geleceƒüimize Not Bƒ±rak</h2>
        <textarea id="noteInput" placeholder="Buraya kalbinden ge√ßenleri yaz sevgilim..."></textarea>
        <p style="font-size: 0.85rem; color: #ff80ab; margin-bottom: 5px;">Parmaklarƒ±nla buraya bir ≈üeyler karala...</p>
        <div id="canvas-wrap">
            <canvas id="noteCanvas"></canvas>
        </div>
        <button class="heart-btn" onclick="clearCanvas()" style="background: #444; font-size: 0.8rem; padding: 10px 20px;">Temizle</button>
        <br>
        <button class="heart-btn" onclick="saveNote()">Notu Kaydet ‚ù§Ô∏è</button>
        <button class="heart-btn" onclick="backToMenu()" style="background: #333;">Geri D√∂n</button>
        <div id="notes-list"></div>
    </div>

    <script>
        const TANI≈ûMA_TARƒ∞Hƒ∞ = "2025-04-03"; 
        // Orijinal 15 mesajƒ±nƒ±z eksiksiz korundu
        const mesajlar = [
            "Hen√ºz birbirimizden habersizken bile kalplerimiz bu g√ºn i√ßin atƒ±yormu≈ü...",
            "Daha 'biz' olmadan √∂nce √ßekilen bu kare, hayatƒ±mƒ±n en g√ºzel d√∂n√ºm noktasƒ±ymƒ±≈ü.",
            "'G√∂zleriniz birbirine ne kadar benziyor' dedikleri o g√ºn, ruhlarƒ±mƒ±zƒ±n benzerliƒüini ke≈üfetmi≈ütik.",
            "Bakmaya doyamadƒ±ƒüƒ±m her karemizde, d√ºnyam seninle daha parlak g√∂r√ºn√ºyor.",
            "Sadece bir fotoƒüraf deƒüil, senin yanƒ±nda kendimi bulduƒüum bir sƒ±ƒüƒ±nak bu.",
            "Zamanƒ±n durmasƒ±nƒ± istediƒüim binlerce andan sadece biri...",
            "Sen benim en g√ºzel manzaramsƒ±n, her bakƒ±≈üta yeniden huzur bulduƒüum.",
            "Birlikte √ßocuk gibi eƒülenebildiƒüim tek insan olman ne b√ºy√ºk ≈üans!",
            "A≈ük sadece el ele tutu≈ümak deƒüil, sa√ßmalarken bile aynƒ± ritimde olmaktƒ±r.",
            "G√ºl√º≈ü√ºn√ºn i√ßinde saklƒ± olan o ne≈üe, en k√∂t√º g√ºn√ºm√ºn bile ilacƒ±.",
            "Seninle g√ºlmekten yorulmak, hayatƒ±n bana sunduƒüu en g√ºzel yorgunluk.",
            "D√ºnyanƒ±n en komik ama en romantik sahnelerinin ba≈ürol√º her zaman biziz.",
            "Aynƒ± renklere g√∂n√ºl vermek, aynƒ± heyecanla birle≈ümek... Galibiyetimiz hep 'biz' olalƒ±m.",
            "D√ºnyaya senin g√∂zlerinden bakmak, g√∂rd√ºƒü√ºm en g√ºzel ger√ßeklik.",
            "T√ºm dileklerinin ger√ßek olduƒüu, hayallerimizle s√ºsl√º nice mutlu senelerimize √∂mr√ºmmmmm:)"
        ];

        let currentIndex = 0;
        const mainMusic = document.getElementById('mainMusic');
        const canvas = document.getElementById('noteCanvas');
        const ctx = canvas.getContext('2d');
        let drawing = false;

        function checkPassword() {
            if(document.getElementById('passInput').value === "2240") {
                document.getElementById('login-screen').style.display = 'none';
                
                // KO≈ûUL: Eƒüer not varsa Men√ºye, yoksa Slayt Ba≈ülangƒ±cƒ±na (Saya√ß) git
                if(localStorage.getItem('ask_notlari')) {
                    document.getElementById('menu-screen').style.display = 'block';
                } else {
                    document.getElementById('start-screen').style.display = 'block';
                }
                
                updateTimer();
                setInterval(updateTimer, 1000);
                initCanvas();
            } else { alert("Hatalƒ± ≈üifre hayatƒ±m!"); }
        }

        function updateTimer() {
            const start = new Date(TANI≈ûMA_TARƒ∞Hƒ∞);
            const now = new Date();
            const diff = now - start;
            const days = Math.floor(diff / 86400000);
            const hours = Math.floor((diff % 86400000) / 3600000);
            const mins = Math.floor((diff % 3600000) / 60000);
            const secs = Math.floor((diff % 60000) / 1000);
            const timeStr = `${days} G√ºn, ${hours} Saat, ${mins} Dakika, ${secs} Saniye`;
            if(document.getElementById('timer')) document.getElementById('timer').innerText = timeStr;
            if(document.getElementById('timer-menu')) document.getElementById('timer-menu').innerText = timeStr;
        }

        function startStory() {
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('clip-container').style.display = 'block';
            currentIndex = 0;
            mainMusic.play();
            showNext();
            confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
        }

        function showNext() {
            let media = document.getElementsByClassName("myMedia");
            let textDiv = document.getElementById("message-text");

            if (currentIndex >= media.length) {
                textDiv.innerHTML = `Sonsuza dek seninle... ‚ù§Ô∏è <br><br> 
                    <button class='heart-btn' onclick='restartStory()' style='font-size: 0.8rem;'>Ba≈ütan ƒ∞zle</button>
                    <button class='heart-btn' onclick='openNoteScreen()' style='font-size: 0.8rem; background: #ad1457;'>Not Bƒ±rak</button>`;
                return;
            }

            for (let i = 0; i < media.length; i++) { 
                media[i].style.display = "none"; 
                if(media[i].tagName === "VIDEO") media[i].pause(); 
            }

            let currentItem = media[currentIndex];
            currentItem.style.display = "block";
            textDiv.innerHTML = mesajlar[currentIndex];
            currentIndex++;

            if (currentItem.tagName === "VIDEO") {
                currentItem.currentTime = 0; 
                currentItem.play();
                currentItem.onended = () => showNext();
            } else {
                setTimeout(showNext, 6000); 
            }
        }

        // √áizim Sistemi
        function initCanvas() {
            const wrap = document.getElementById('canvas-wrap');
            canvas.width = wrap.offsetWidth;
            canvas.height = wrap.offsetHeight;
            ctx.strokeStyle = "#ff4081";
            ctx.lineWidth = 4;
            ctx.lineCap = "round";

            const getPos = (e) => {
                const rect = canvas.getBoundingClientRect();
                return {
                    x: (e.clientX || e.touches[0].clientX) - rect.left,
                    y: (e.clientY || e.touches[0].clientY) - rect.top
                };
            };

            const start = (e) => { drawing = true; const pos = getPos(e); ctx.beginPath(); ctx.moveTo(pos.x, pos.y); };
            const move = (e) => { if(!drawing) return; const pos = getPos(e); ctx.lineTo(pos.x, pos.y); ctx.stroke(); };
            const stop = () => drawing = false;

            canvas.addEventListener('mousedown', start);
            canvas.addEventListener('mousemove', move);
            window.addEventListener('mouseup', stop);
            canvas.addEventListener('touchstart', start, {passive: false});
            canvas.addEventListener('touchmove', move, {passive: false});
            canvas.addEventListener('touchend', stop);
        }

        function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

        function openNoteScreen() {
            document.getElementById('clip-container').style.display = 'none';
            document.getElementById('menu-screen').style.display = 'none';
            document.getElementById('note-screen').style.display = 'block';
            displayNotes();
            setTimeout(initCanvas, 100);
        }

        function saveNote() {
            const text = document.getElementById('noteInput').value;
            const img = canvas.toDataURL();
            const notes = JSON.parse(localStorage.getItem('ask_notlari') || "[]");
            notes.unshift({ text, image: img, date: new Date().toLocaleString('tr-TR') });
            localStorage.setItem('ask_notlari', JSON.stringify(notes));
            
            confetti({ particleCount: 150, spread: 100 });
            alert("Notun kalbime i≈ülendi!");
            location.reload(); // Men√ºye ge√ßi≈üi tetiklemek i√ßin
        }

        function displayNotes() {
            const notes = JSON.parse(localStorage.getItem('ask_notlari') || "[]");
            document.getElementById('notes-list').innerHTML = notes.map(n => `
                <div class="note-item">
                    <span style="font-size:0.7rem; color:#ff80ab">${n.date}</span><br>
                    <div style="margin:5px 0">${n.text}</div>
                    <img src="${n.image}" class="note-img">
                </div>
            `).join('');
        }

        function backToMenu() {
            if(localStorage.getItem('ask_notlari')) {
                document.getElementById('note-screen').style.display = 'none';
                document.getElementById('menu-screen').style.display = 'block';
            } else {
                location.reload();
            }
        }

        function restartStory() {
            currentIndex = 0;
            startStory();
        }
    </script>
</body>
</html>
